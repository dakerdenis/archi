<style>
    <?php include './style/goods.css' ?>html {}
</style>
<div class="goods__page__categories goods__page__categories_owner">
    <div class="goods__page__categories_owner__block">
        <div class="goods__owner__links">
            <a class="goods__owner__link_blue" href="#">
                <p>Личный Кабинет</p>
            </a>
            <span> > </span>
            <a class="goods__owner__link_blue" href="#">
                <p>Мои Товары</p>
            </a>
            <span> > </span>
            <a class="" href="#">
                <p>Название категории</p>
            </a>
        </div>
    </div>
</div>

<div class="goods__page__container">
    <div class="goods__owner__addgoods">
        <a href="./index.php?page=new_item">
            <img src="./imgs/plus_1.jpg" alt="">
        </a>
        <button id="toggleButtonDelete">
            <img src="./imgs/delete.png" alt="">
        </button>
    </div>
    <div class="goods__page__wrapper">

        <div class="goods__page__filtr">
            <!---//!---FILTR---->
            <!---//!---FILTR---->
            <!---//!---FILTR---->
            <div class="main__filter__container">
                <div class="main__filter__name">
                    <p>Фильтр</p>
                </div>

                <div class="main__filter__description">
                    <p>Подкатегория</p>
                </div>


                <div class="additional__container">
                    <div class="additional__container__block">



                        <div class="custom-select" id="selectContainer1">
                            <div class="select-box">
                                <div class="select-value">Categories</div>
                                <ul class="select-options"></ul>
                            </div>
                            <div class="arrow"></div>
                        </div>

                        <div class="custom-select" id="selectContainer2" style="display: none;">
                            <div class="select-box">
                                <div class="select-value">Subcategories</div>
                                <ul class="select-options"></ul>
                            </div>
                            <div class="arrow"></div>
                        </div>

                        <!-- Properties will be added dynamically -->














                    </div>
                </div>

                <div class="main__filter__search">
                    <button>
                        <p>Применить</p>
                    </button>
                </div>
            </div>
            <!---//!---FILTR---->
            <!---//!---FILTR---->
            <!---//!---FILTR---->


        </div>




        <!---//?---CONTENT WRAPPER---->
        <div class="goods__page__content__wrapper">
            <div class="goods__page__content__wrapper_">
                <!------------>
                <div class="goods__page__element">
                    <div class="page__element__image">
                        <div class="delete__element_" data-id="1">
                            <p class="openPopup" id="openPopup">x</p>
                        </div>
                        <img src="./imgs/1.jpg" alt="">
                    </div>
                    <div class="page__element__content">
                        <div class="page__element__name">
                            <a href="./index.php?page=item">
                                <p>Товар китай покемон fasfasfasf</p>
                            </a>
                        </div>
                        <div class="page__element__size">
                            <p>210 x 300 x 69</p>
                        </div>
                        <div class="page__element__material">
                            <p>материал</p>
                        </div>
                    </div>
                </div>
                <!------------>
                <!------------>
                <!------------>
                <div class="goods__page__element">
                    <div class="page__element__image">
                        <div class="delete__element_" data-id="2">
                            <p class="openPopup" id="openPopup">x</p>
                        </div>
                        <img src="./imgs/1.jpg" alt="">
                    </div>
                    <div class="page__element__content">
                        <div class="page__element__name">
                            <a href="./index.php?page=item">
                                <p>Товар китай покемон fasfasfasf</p>
                            </a>
                        </div>
                        <div class="page__element__size">
                            <p>210 x 300 x 69</p>
                        </div>
                        <div class="page__element__material">
                            <p>материал</p>
                        </div>
                    </div>
                </div>
                <!------------>
                <!------------>
                <!------------>
                <div class="goods__page__element">
                    <div class="page__element__image">
                        <div class="delete__element_" data-id="3">
                            <p class="openPopup" id="openPopup">x</p>
                        </div>
                        <img src="./imgs/1.jpg" alt="">
                    </div>
                    <div class="page__element__content">
                        <div class="page__element__name">
                            <a href="./index.php?page=item">
                                <p>Товар китай покемон fasfasfasf</p>
                            </a>
                        </div>
                        <div class="page__element__size">
                            <p>210 x 300 x 69</p>
                        </div>
                        <div class="page__element__material">
                            <p>материал</p>
                        </div>
                    </div>
                </div>
                <!------------>
                <!------------>
                <!------------>
                <div class="goods__page__element">
                    <div class="page__element__image">
                        <div class="delete__element_" data-id="4">
                            <p class="openPopup" id="openPopup">x</p>
                        </div>
                        <img src="./imgs/1.jpg" alt="">
                    </div>
                    <div class="page__element__content">
                        <div class="page__element__name">
                            <a href="./index.php?page=item">
                                <p>Товар китай покемон fasfasfasf asdasdasda asdasddas</p>
                            </a>
                        </div>
                        <div class="page__element__size">
                            <p>210 x 300 x 69</p>
                        </div>
                        <div class="page__element__material">
                            <p>материал</p>
                        </div>
                    </div>
                </div>
                <!------------>
                <!------------>
                <!------------>
                <div class="goods__page__element">
                    <div class="page__element__image">
                        <div class="delete__element_" data-id="5">
                            <p class="openPopup" id="openPopup">x</p>
                        </div>
                        <img src="./imgs/1.jpg" alt="">
                    </div>
                    <div class="page__element__content">
                        <div class="page__element__name">
                            <a href="./index.php?page=item">
                                <p>Товар китай покемон fasfasfasf</p>
                            </a>
                        </div>
                        <div class="page__element__size">
                            <p>210 x 300 x 69</p>
                        </div>
                        <div class="page__element__material">
                            <p>материал</p>
                        </div>
                    </div>
                </div>
                <!------------>
                <!------------>














            </div>
        </div>

    </div>
</div>



<div class="popup-overlay" id="popupOverlay">
    <form class="popup popup__delete__element" id="popup">
        <span class="close" id="closePopup">X</span>
        <div class="popup__content__delete">
            <div class="popup__eleement__delete__name">
                <p>Удалить объявление?</p>
            </div>
            <input type="text" id="blockIdInput" readonly>
            <div class="popup__element__delete__button">
                <button>
                    <p>Удалить</p>
                </button>
            </div>
        </div>
    </form>
</div>


<script>
    const openPopupButtons = document.querySelectorAll(".openPopup");
    const popupOverlay = document.getElementById("popupOverlay");
    const closePopupButton = document.getElementById("closePopup");
    const blockIdInput = document.getElementById("blockIdInput");

    openPopupButtons.forEach(button => {
        button.addEventListener("click", function() {
            const block = this.closest(".delete__element_");
            const blockId = block.getAttribute("data-id");
            blockIdInput.value = blockId;
            popupOverlay.style.display = "block";
        });
    });

    closePopupButton.addEventListener("click", function() {
        popupOverlay.style.display = "none";
    });

    popupOverlay.addEventListener("click", function(event) {
        if (event.target === popupOverlay) {
            popupOverlay.style.display = "none";
        }
    });

    document.addEventListener("keydown", function(event) {
        if (event.key === "Escape") {
            popupOverlay.style.display = "none";
        }
    });

    const toggleButton = document.getElementById("toggleButtonDelete");
    const deleteElements = document.querySelectorAll(".delete__element_");

    let visible = false; // Initially, the divs are hidden

    toggleButton.addEventListener("click", () => {
        visible = !visible; // Toggle the visibility flag

        if (visible) {
            // Show the small divs
            deleteElements.forEach(element => {
                element.style.display = "flex";
            });
        } else {
            // Hide the small divs
            deleteElements.forEach(element => {
                element.style.display = "none";
            });
        }
    });







    const selectContainer1 = document.getElementById('selectContainer1');
const selectContainer2 = document.getElementById('selectContainer2');
const arrow1 = selectContainer1.querySelector('.arrow');
const arrow2 = selectContainer2.querySelector('.arrow');
const optionsList1 = selectContainer1.querySelector('.select-options');
const optionsList2 = selectContainer2.querySelector('.select-options');

const data = {
  categories: [
    {
      name: 'Cars',
      subcategories: [
        {
          name: 'Car 1',
          properties: ['Color', 'Weight', 'Price'],
        },
        {
          name: 'Car 2',
          properties: ['Color', 'Weight', 'Price'],
        },
        {
          name: 'Car 3',
          properties: ['Color', 'Weight', 'Price'],
        },
      ],
    },
    {
      name: 'Planes',
      subcategories: [
        {
          name: 'Plane 1',
          properties: ['Color', 'Weight', 'Price', 'Wingspan'],
        },
        {
          name: 'Plane 2',
          properties: ['Color', 'Weight', 'Price', 'Wingspan'],
        },
      ],
    },
    {
      name: 'Helicopters',
      subcategories: [
        {
          name: 'Helicopter 1',
          properties: ['Color', 'Weight'],
        },
        {
          name: 'Helicopter 2',
          properties: ['Color', 'Weight'],
        },
        {
          name: 'Helicopter 3',
          properties: ['Color', 'Weight'],
        },
      ],
    },
  ],
};

// Function to close the dropdown
function closeDropdown(container, arrow) {
  container.style.display = 'none';
  arrow.style.transform = 'translateY(-50%) rotate(0deg)';
}

// Create options for the first container based on the dynamic data
function createCategories() {
  optionsList1.innerHTML = '';
  data.categories.forEach((category) => {
    const option = document.createElement('li');
    option.textContent = category.name;
    option.setAttribute('data-value', category.name);
    optionsList1.appendChild(option);
  });
}

// Create subcategories for the second container based on the selected category
function createSubcategories(selectedCategory) {
  optionsList2.innerHTML = '';
  const selectedCategoryData = data.categories.find((category) => category.name === selectedCategory);

  if (selectedCategoryData) {
    selectedCategoryData.subcategories.forEach((subcategory) => {
      const option = document.createElement('li');
      option.textContent = subcategory.name;
      option.setAttribute('data-value', subcategory.name);
      optionsList2.appendChild(option);
    });
  }
}

// Create property containers and options based on the selected subcategory
function createPropertyContainersAndOptions(selectedSubcategory) {
  // Close any open property containers
  document.querySelectorAll('.property-container').forEach((container) => {
    closeDropdown(container.querySelector('.select-options'), container.querySelector('.arrow'));
  });

  // Get the selected subcategory data
  const selectedCategoryData = data.categories.find((category) => category.name === selectContainer1.querySelector('.select-value').textContent);
  if (!selectedCategoryData) return;

  const selectedSubcategoryData = selectedCategoryData.subcategories.find((subcategory) => subcategory.name === selectedSubcategory);
  if (!selectedSubcategoryData) return;

  // Create property containers and options
  selectedSubcategoryData.properties.forEach((property, index) => {
    const propertyContainer = document.createElement('div');
    propertyContainer.classList.add('custom-select', 'property-container');
    propertyContainer.style.display = 'none';

    propertyContainer.innerHTML = `
      <div class="select-box">
        <div class="select-value">${property}</div>
        <ul class="select-options"></ul>
      </div>
      <div class="arrow"></div>
    `;

    document.body.appendChild(propertyContainer);

    const optionsListProperty = propertyContainer.querySelector('.select-options');

    // Generate unique property values (for demonstration, we use index as a suffix)
    const propertyValues = Array.from({ length: 5 }, (_, i) => `${property} ${i + 1}`);

    propertyValues.forEach((value) => {
      const option = document.createElement('li');
      option.textContent = value;
      option.setAttribute('data-value', value);
      optionsListProperty.appendChild(option);
    });
  }
}

selectContainer1.addEventListener('click', () => {
  optionsList1.style.display = optionsList1.style.display === 'block' ? 'none' : 'block';
  arrow1.style.transform = optionsList1.style.display === 'block' ? 'translateY(-50%) rotate(180deg)' : 'translateY(-50%) rotate(0deg)';
});

selectContainer2.addEventListener('click', (event) => {
  optionsList2.style.display = optionsList2.style.display === 'block' ? 'none' : 'block';
  arrow2.style.transform = optionsList2.style.display === 'block' ? 'translateY(-50%) rotate(180deg)' : 'translateY(-50%) rotate(0deg)';
  event.stopPropagation(); // Prevent the click event from propagating
});

document.addEventListener('click', (event) => {
  if (
    !selectContainer1.contains(event.target) &&
    !selectContainer2.contains(event.target)
  ) {
    closeDropdown(optionsList1, arrow1);
    closeDropdown(optionsList2, arrow2);
  }
});

optionsList1.addEventListener('click', (event) => {
  const selectedCategory = event.target.getAttribute('data-value');
  selectContainer1.querySelector('.select-value').textContent = event.target.textContent;
  createSubcategories(selectedCategory);
  selectContainer2.style.display = 'block';
  selectContainer2.querySelector('.select-value').textContent = 'Subcategories';

  // Close any open property containers
  document.querySelectorAll('.property-container').forEach((container) => {
    closeDropdown(container.querySelector('.select-options'), container.querySelector('.arrow'));
    container.style.display = 'none';
  });
});

optionsList2.addEventListener('click', (event) => {
  selectContainer2.querySelector('.select-value').textContent = event.target.textContent;
  const selectedSubcategory = event.target.getAttribute('data-value');
  createPropertyContainersAndOptions(selectedSubcategory);

  // Close any open property containers
  document.querySelectorAll('.property-container').forEach((container) => {
    closeDropdown(container.querySelector('.select-options'), container.querySelector('.arrow'));
    container.style.display = 'none';
  });
});

</script>